<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>nope</title>
		<link rel="icon" href="../../images/favicon.png" sizes="16x16" type="image/png">
		<link rel="stylesheet" type="text/css" href="logic.css">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
	</head>
	<body>
		<script src="https://threejs.org/build/three.min.js"></script>
		<script>
			var x = 0, z = 10, dir = 1, target = 0, next = 1, last = 1;
			var data = 29834759837459873;
			var converted = (data >>> 0).toString(2);
			
			var matrix = [];
			
			var scene = new THREE.Scene();
			//scene.background = new THREE.Color( 0xffffff );
			var camera = new THREE.PerspectiveCamera( 75, window.innerWidth/window.innerHeight, 0.1, 1000 );

			var renderer = new THREE.WebGLRenderer( { antialias: true } );
			renderer.setSize( window.innerWidth, window.innerHeight );
			document.body.appendChild( renderer.domElement );
						var geometry = new THREE.BoxGeometry( 0.1, 0.1, 0.1 );
						var material = new THREE.MeshStandardMaterial( { color: 0x0000ff } );
						var cube = new THREE.Mesh( geometry, material );
						cube.position.set( 0, 2, 5 );
						scene.add( cube );

			var n = 0;
			for ( var i = 0; i <= 5; i++ ) {
				var row = [];
				for ( var j = 0; j <= 5; j++ ) {
					row.push(converted.charAt(n) === "1");
					if (converted.charAt(n) === "1") {
						var geometry = new THREE.BoxGeometry( 1, 1, 1 );
						var material = new THREE.MeshStandardMaterial( { color: 0x0000ff } );
						var cube = new THREE.Mesh( geometry, material );
						cube.position.set( i, 0, j );
						scene.add( cube );
					}
					n++;
				}
				console.log(row);
				matrix.push(row);
			}
				
			var light = new THREE.HemisphereLight( 0xffffff, 0x000000, 1 );
			scene.add( light );
			

			var animate = function () {
				requestAnimationFrame( animate );
				
				var center = Math.abs(x % 1) < 0.05 && Math.abs(z % 1) < 0.05;
				console.log(center);
				
				if (center) {
					dir = next;
				}
				if (dir === 0) {
					if ( !center || x < 1 || z < 0 || x >= matrix.length + 1 || z >= matrix[0].length || 
						!matrix[Math.round(x) - 1][Math.round(z)] ) {
						x -= 0.05;
					}
				} else if (dir === 1) {
					if ( !center || x < 0 || z < 1 || x >= matrix.length || z >= matrix[0].length + 1 || 
						!matrix[Math.round(x)][Math.round(z) - 1] ) {
						z -= 0.05;
					}
				} else if (dir === 2) {
					if ( !center || x < -1 || z < 0 || x >= matrix.length - 1 || z >= matrix[0].length || 
						!matrix[Math.round(x) + 1][Math.round(z)] ) {
						x += 0.05;
					}
				} else {
					if ( !center || x < 0 || z < -1 || x >= matrix.length || z >= matrix[0].length - 1 || 
						!matrix[Math.round(x)][Math.round(z) + 1] ) {
						z += 0.05;
					}
				}
				
				camera.position.set( x, 1, z );
				light.position.set( x, 0, z );
				
				var actual = Math.PI * -(dir - 1) / 2;
				if (next === 3 && last === 0) {
					actual = Math.PI;
				}
				if (next === 0 && last === 3 && target < 0) {
					target = -target;
				}
				if (actual > target) {
					target += 0.1;
				} else if (actual < target) {
					target -= 0.1;
				}
				if (Math.abs(actual - target) < 0.05) {
					target = actual;
				}
				camera.rotation.y = target;

				renderer.render(scene, camera);
			};

			animate();
			
			document.body.onkeydown = function() {
				if (dir === next) {
					last = dir;
					if (window.event.keyCode === 37) {
						next = (dir + 3) % 4;
					} else if (window.event.keyCode === 39) {
						next = (dir + 1) % 4;
					}
				}
				console.log(next + "   " + last);
			}
		</script>
	</body>
</html>
