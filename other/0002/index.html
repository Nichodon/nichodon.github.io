<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Marbleslides 2.0 by Moomath</title>
		<link rel="stylesheet" type="text/css" href="graph.css">
		<link rel="stylesheet" href="build/mathquill.css"/>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
		<script src="build/mathquill.js"></script>
		<script>
			var MQ = MathQuill.getInterface(2);
		</script>
	</head>
	
	<body>
		<div id="title">Marbleslides 2.0 by Moomath</div>
		<div id="controls">
			<ul>
				<li onClick="add()">
					<button class="count">New</button>
					<div style="clear:both"></div>
				</li>
			</ul>
		</div>
		<script src="graph.js"></script>
		<script>
			var num = 1;
			var child = document.getElementById("controls").children[0];
			
			function add() {
				var li = document.createElement("li");
				
				var count = document.createElement("button");
				count.innerHTML = child.children.length;
				count.classList.add("count");
				count.onclick = function() {
					toggle(count);
				};
				li.appendChild(count);
				
				var p = document.createElement("p");
				var span = document.createElement("span");
				span.id = "e" + num;
				p.appendChild(span);
				li.appendChild(p);
				
				var settings = document.createElement("button");
				settings.innerHTML = "&#9881;";
				li.appendChild(settings);
				
				var remove = document.createElement("button");
				remove.innerHTML = "&#128473;";
				remove.onclick = function() {
					backspace(li);	
				};
				li.appendChild(remove);
				
				var div = document.createElement("div");
				div.style.clear = "both";
				li.appendChild(div);
				
				child.insertBefore(li, child.children[child.children.length - 1]);
				MQ.MathField(document.getElementById("e" + num)).focus();
				num++;
			}
			
			function toggle(x) {
				if (x.classList.contains("off")) {
					x.classList.remove("off");
				} else {
					x.classList.add("off");
				}
			}
			
			function backspace(x) {
				child.removeChild(x);
				var children = child.children;
				for (var i = 0; i < children.length - 1; i++) {
					children[i].children[0].innerHTML = i + 1;
				}
			}
			
			add();
		</script>
	</body>
</html>
